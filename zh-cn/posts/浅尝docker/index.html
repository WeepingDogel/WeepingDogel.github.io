<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>浅尝 Docker - WeepingDogel 的博客</title><meta name="Description" content="迟早要学的 Docker ， 先尝试一下吧"><meta property="og:title" content="浅尝 Docker" />
<meta property="og:description" content="迟早要学的 Docker ， 先尝试一下吧" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" /><meta property="og:image" content="http://weepingdogel.github.io/photo_2021-07-21_03-31-50.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-15T20:21:13+08:00" />
<meta property="article:modified_time" content="2022-10-15T20:21:13+08:00" /><meta property="og:site_name" content="My cool site" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://weepingdogel.github.io/photo_2021-07-21_03-31-50.jpg" /><meta name="twitter:title" content="浅尝 Docker"/>
<meta name="twitter:description" content="迟早要学的 Docker ， 先尝试一下吧"/>
<meta name="twitter:site" content="@weepingdogel_me"/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" /><link rel="prev" href="http://weepingdogel.github.io/zh-cn/posts/%E4%B8%80%E5%A4%A9%E5%88%B7%E5%AE%8Clinux%E7%BD%91%E7%BB%9C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%BA%94%E7%94%A8%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E8%BF%99%E6%9C%AC%E4%B9%A6/" /><link rel="next" href="http://weepingdogel.github.io/zh-cn/posts/something-about-html-css/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><meta name="google-site-verification" content="twaX9bmrayAeCFiSLFsfosnmEjKpOlWNLIYKt5ZIno4" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "浅尝 Docker",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/weepingdogel.github.io\/zh-cn\/posts\/%E6%B5%85%E5%B0%9Ddocker\/"
        },"genre": "posts","keywords": "docker, 运维, 容器, Linux, Web, 云计算, 云服务","wordcount":  4227 ,
        "url": "http:\/\/weepingdogel.github.io\/zh-cn\/posts\/%E6%B5%85%E5%B0%9Ddocker\/","datePublished": "2022-10-15T20:21:13+08:00","dateModified": "2022-10-15T20:21:13+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "WeepingDogel"
            },"description": "迟早要学的 Docker ， 先尝试一下吧"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/zh-cn/" title="WeepingDogel 的博客"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/photo_2021-07-21_03-31-50.jpg"
        data-srcset="/photo_2021-07-21_03-31-50.jpg, /photo_2021-07-21_03-31-50.jpg 1.5x, /photo_2021-07-21_03-31-50.jpg 2x"
        data-sizes="auto"
        alt="/photo_2021-07-21_03-31-50.jpg"
        title="/photo_2021-07-21_03-31-50.jpg" />WeepingDogel</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/zh-cn/posts/"> 文章 </a><a class="menu-item" href="/zh-cn/tags/"> 标签 </a><a class="menu-item" href="/zh-cn/categories/"> 分类 </a><a class="menu-item" href="/zh-cn/about/"> 关于我 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="选择语言">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" selected>简体中文</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/zh-cn/" title="WeepingDogel 的博客"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/photo_2021-07-21_03-31-50.jpg"
        data-srcset="/photo_2021-07-21_03-31-50.jpg, /photo_2021-07-21_03-31-50.jpg 1.5x, /photo_2021-07-21_03-31-50.jpg 2x"
        data-sizes="auto"
        alt="/photo_2021-07-21_03-31-50.jpg"
        title="/photo_2021-07-21_03-31-50.jpg" />WeepingDogel</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/zh-cn/posts/" title="">文章</a><a class="menu-item" href="/zh-cn/tags/" title="">标签</a><a class="menu-item" href="/zh-cn/categories/" title="">分类</a><a class="menu-item" href="/zh-cn/about/" title="">关于我</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="选择语言">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" selected>简体中文</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">浅尝 Docker</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://weepingdogel.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>WeepingDogel</a></span>&nbsp;<span class="post-category">收录于 <a href="/zh-cn/categories/%E8%BF%90%E7%BB%B4/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>运维</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-10-15">2022-10-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;约 4227 字&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;预计阅读 9 分钟&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://w.wallhaven.cc/full/d5/wallhaven-d5we7o.png"
        data-srcset="https://w.wallhaven.cc/full/d5/wallhaven-d5we7o.png, https://w.wallhaven.cc/full/d5/wallhaven-d5we7o.png 1.5x, https://w.wallhaven.cc/full/d5/wallhaven-d5we7o.png 2x"
        data-sizes="auto"
        alt="https://w.wallhaven.cc/full/d5/wallhaven-d5we7o.png"
        title="迟早要学的 Docker ， 先尝试一下吧" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#序">序</a></li>
    <li><a href="#docker-是什么">docker 是什么？</a></li>
    <li><a href="#怎么安装-docker">怎么安装 docker</a>
      <ul>
        <li><a href="#arch">Arch</a></li>
        <li><a href="#debian">Debian</a>
          <ul>
            <li><a href="#设置仓库">设置仓库</a></li>
            <li><a href="#安装-docker">安装 docker</a></li>
          </ul>
        </li>
        <li><a href="#rpm-系列">rpm 系列</a>
          <ul>
            <li><a href="#设置仓库-1">设置仓库</a></li>
            <li><a href="#安装">安装</a></li>
          </ul>
        </li>
        <li><a href="#对于-linux-平台再提一嘴">对于 Linux 平台再提一嘴</a></li>
        <li><a href="#windows">Windows</a></li>
      </ul>
    </li>
    <li><a href="#我能怎么玩-docker">我能怎么玩 docker？</a>
      <ul>
        <li><a href="#helloworld">HelloWorld</a></li>
        <li><a href="#交互式容器">交互式容器</a></li>
        <li><a href="#以-daemon-模式来运行容器">以 daemon 模式来运行容器</a></li>
        <li><a href="#删除容器">删除容器</a></li>
        <li><a href="#镜像">镜像</a></li>
        <li><a href="#删除镜像">删除镜像</a></li>
        <li><a href="#dockerfile">dockerfile</a></li>
        <li><a href="#一个简单的-web-服务器">一个简单的 Web 服务器.</a></li>
      </ul>
    </li>
    <li><a href="#结语">结语</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="序">序</h1>
<p>嗯，未雨绸缪，提前学一下怎么玩 docker 。</p>
<p><del>卷死他们</del></p>
<h1 id="docker-是什么">docker 是什么？</h1>
<p><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>官方英文简介<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Docker is an open platform for developing, shipping, and running applications. Docker enables you to separate your applications from your infrastructure so you can deliver software quickly. With Docker, you can manage your infrastructure in the same ways you manage your applications. By taking advantage of Docker’s methodologies for shipping, testing, and deploying code quickly, you can significantly reduce the delay between writing code and running it in production.</div>
        </div>
    </div>
根据官方文档的说明和通俗的理解， docker 能够提供快速部署软件项目的容器，它相当于一个可以模拟项目所需环境的虚拟机，但又和我们理解的一般的虚拟机又不同。</p>
<p>一般的虚拟机需要安装整个操作系统，会对我们的计算机占用大量的资源，而 docker 只需要模拟出项目所需要的运行环境，占用率非常低，这可以大大提高开发效率。</p>
<p>它可以按照我们的需求模拟出软件环境，并且能够快速部署我们开发好的项目实例（比如 Mastodon），并且一定程度上它具有环境隔离功能，运行环境与操作系统相分离，而且可以同时运行多个容器。</p>
<p>并且我们可以把容器封装成镜像，进行反复利用。</p>
<p>就像这条运着集装箱的鲸鱼一样，游到哪都是开箱即用。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://www.runoob.com/wp-content/uploads/2016/04/docker01.png"
        data-srcset="https://www.runoob.com/wp-content/uploads/2016/04/docker01.png, https://www.runoob.com/wp-content/uploads/2016/04/docker01.png 1.5x, https://www.runoob.com/wp-content/uploads/2016/04/docker01.png 2x"
        data-sizes="auto"
        alt="https://www.runoob.com/wp-content/uploads/2016/04/docker01.png"
        title="https://www.runoob.com/wp-content/uploads/2016/04/docker01.png" /></p>
<h1 id="怎么安装-docker">怎么安装 docker</h1>
<p>各个平台装 docker 都非常简单。</p>
<p>Linux 平台可能对初学者稍微难一些，但是对熟悉的用户来说， Linux 安装 docker 非常快。</p>
<p>直接从相应发行版的包管理器安装就行。</p>
<h2 id="arch">Arch</h2>
<p>比如咱 Arch 可以让 pacman 把这条鲸鱼给带回来。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo pacman -S docker
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>注意<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>如果运行时出现以下报错</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">docker</span><span class="p">:</span> <span class="n">Cannot</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Docker</span> <span class="n">daemon</span> <span class="n">at</span> <span class="n">unix</span><span class="p">:</span><span class="o">///</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">docker</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span> <span class="n">Is</span> <span class="n">the</span> <span class="n">docker</span> <span class="n">daemon</span> <span class="n">running</span><span class="err">?</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">See</span> <span class="s1">&#39;docker run --help&#39;</span><span class="o">.</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>请使用 <code>systemctl</code> 启动 <code>docker</code> 的系统进程。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo systemctl start docker
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果有必要，设置其开机自启</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo systemctl enable docker
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<h2 id="debian">Debian</h2>
<p>如果是用 deb 系的发行版，可以参考<a href="https://docs.docker.com/engine/install/debian/#install-docker-engine" target="_blank" rel="noopener noreffer ">官方文档</a>用 apt 来安装。</p>
<h3 id="设置仓库">设置仓库</h3>
<ol>
<li>更新 apt 仓库，并安装一些依赖来允许 apt 通过 https 使用第三方仓库。</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt update
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt install ca-certificates curl gnupg lsb-release
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>添加 Docker 官方 GPG 密钥</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo mkdir -p /etc/apt/keyrings
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">curl</span> <span class="o">-</span><span class="n">fsSL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">docker</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">gpg</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">gpg</span> <span class="o">--</span><span class="n">dearmor</span> <span class="o">-</span><span class="n">o</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">keyrings</span><span class="o">/</span><span class="n">docker</span><span class="o">.</span><span class="n">gpg</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>设置 Docker 仓库</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="s2">&#34;deb [arch=</span><span class="k">$(</span>dpkg --print-architecture<span class="k">)</span><span class="s2"> signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \
</span></span></span><span class="line"><span class="cl"><span class="s2">  </span><span class="k">$(</span>lsb_release -cs<span class="k">)</span><span class="s2"> stable&#34;</span> <span class="p">|</span> sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="安装-docker">安装 docker</h3>
<ol>
<li>更新软件包仓库</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt update
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果更新的时候发生了 GPG 错误，可以参考官网的<a href="https://docs.docker.com/engine/install/debian/#install-docker-engine" target="_blank" rel="noopener noreffer ">这个提示</a>：</p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>Receiving a GPG error when running apt-get update?<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>Your default <a href="https://en.wikipedia.org/wiki/Umask" target="_blank" rel="noopener noreffer ">umask</a> may be incorrectly configured, preventing detection of the repository public key file. Try granting read permission for the Docker public key file before updating the package index:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> $ sudo chmod a+r /etc/apt/keyrings/docker.gpg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> $ sudo apt-get update
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<ol start="2">
<li>安装 Docker Engine 、 containerd 和 Docker Compose.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt install docker-ce docker-ce-cli containerd.io docker-compose-plugin
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>通过运行 hello-world 镜像来验证 docker 是否安装成功</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker run hello-world
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="rpm-系列">rpm 系列</h2>
<p>其实说实话，这类发行版我个人不太喜欢，就拿 CentOS 为例吧，CentOS 7 以上的版本也是可以直接用 yum 安装的。</p>
<h3 id="设置仓库-1">设置仓库</h3>
<p>一样是设置第三方仓库。</p>
<p>不过要先安装 <code>yum-utils</code> 才能用 <code>yum-config-manager</code>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo yum install -y yum-utils
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后设置仓库</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">yum</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">manager</span> \
</span></span><span class="line"><span class="cl">    <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">repo</span> \
</span></span><span class="line"><span class="cl">    <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">docker</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">centos</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">ce</span><span class="o">.</span><span class="n">repo</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="安装">安装</h3>
<p>一样是使用 yum 命令来安装 docker 的软件包和依赖。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="对于-linux-平台再提一嘴">对于 Linux 平台再提一嘴</h2>
<p>上述的方法都是在 Linux 平台安装 docker 的最新版本，如果需要安装特定的版本，可以<a href="https://docs.docker.com/engine/" target="_blank" rel="noopener noreffer ">参考 docker 的官方文档</a>进行操作。</p>
<h2 id="windows">Windows</h2>
<p>在 Windows 平台可以直接安装 docker-desktop，这也非常简单，直接通过 <a href="https://docs.docker.com/desktop/install/windows-install/" target="_blank" rel="noopener noreffer ">docker 官方文档</a><a href="https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe" target="_blank" rel="noopener noreffer ">下载</a>安装包就行了。</p>
<h1 id="我能怎么玩-docker">我能怎么玩 docker？</h1>
<p>docker 能干的事多着呢。</p>
<p>最常用的就是在 docker 容器里运行应用程序了。</p>
<h2 id="helloworld">HelloWorld</h2>
<p>比如我们来运行一个 Hello World</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker run ubuntu /bin/echo &#34;hello world&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>如图所见，它输出一系列字符后，在最后输出了 hello world</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-07-07-53-37%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-07-07-53-37%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-07-07-53-37%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-07-07-53-37%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-07-07-53-37屏幕截图.png"
        title="/img/2022-11-07-07-53-37屏幕截图.png" /></p>
<p>那么来解释一下命令的含义吧</p>
<ul>
<li><code>docker</code> &ndash; 运行 docker 的二进制文件, 这个没什么好说的</li>
<li><code>run</code> &ndash; 运行容器</li>
<li><code>ubuntu</code> &ndash; 要运行的镜像名称</li>
<li><code>/bin/echo &quot;hello world&quot;</code> - 在容器里面要执行的命令</li>
</ul>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>提示<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>如果出现了以下信息，可能是因为在启动容器的时候没有下载好相关的镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Unable to find image &#39;ubuntu:latest&#39; locally
</span></span><span class="line"><span class="cl">latest: Pulling from library/ubuntu
</span></span><span class="line"><span class="cl">e96e057aae67: Pull complete 
</span></span></code></pre></td></tr></table>
</div>
</div><p>默认情况下 docker 会自动下载，但最好养成启动之前下载好镜像的习惯。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker pull ubuntu
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<h2 id="交互式容器">交互式容器</h2>
<p>当然,我们也可以创建一个可以交互的容器,意思就是可以用 bash 来控制它</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker run -i -t ubuntu /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>参数含义<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li><code>-i</code>: 交互式操作。</li>
<li><code>-t</code>: 终端。</li>
</ul>
<p><a href="https://www.runoob.com/docker/docker-image-usage.html" target="_blank" rel="noopener noreffer ">引自菜鸟教程</a></p></div>
        </div>
    </div>
<p>这样我们创建容器之后,我们的 shell 也变成了容器里的 shell</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-14-22-05%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-14-22-05%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-14-22-05%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-14-22-05%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-14-22-05屏幕截图.png"
        title="/img/2022-11-08-14-22-05屏幕截图.png" /></p>
<p>我们可以对它进行一些操作命令,随便打几个吧.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-14-27-39%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-14-27-39%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-14-27-39%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-14-27-39%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-14-27-39屏幕截图.png"
        title="/img/2022-11-08-14-27-39屏幕截图.png" /></p>
<p>而且我们执行的命令是不会影响到主系统的</p>
<p>然后我们可以使用 <code>exit</code> 命令来退出这个系统.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-14-26-41%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-14-26-41%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-14-26-41%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-14-26-41%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-14-26-41屏幕截图.png"
        title="/img/2022-11-08-14-26-41屏幕截图.png" /></p>
<p>这样一来容器的操作系统就退出了,同时容器也停止运行了, 因为这个容器不是以 daemon 模式来运行的.</p>
<h2 id="以-daemon-模式来运行容器">以 daemon 模式来运行容器</h2>
<p>接下来我要说的是,为啥上文中用 <code>exit</code> 退出容器 shell 之后还不算完.</p>
<p>这次我们再打开一个容器,不过这次加一个参数 <code>-d</code></p>
<p>这个参数的意思是以 Daemon 模式运行, 那么 Daemon 是什么意思呢?</p>
<p>通过搜索引擎得到的答案往往是什么 系统守护进程巴拉巴拉的,其实它类似于后台运行的意思.</p>
<p>接下来我们用这个命令来开个容器</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker run -i -t -d ubuntu /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-14-27-39%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-14-27-39%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-14-27-39%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-14-27-39%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-14-27-39屏幕截图.png"
        title="/img/2022-11-08-14-27-39屏幕截图.png" /></p>
<p>这时我们发现,我们并没有得一个 shell, 而是得到来一串字符串.</p>
<p>我们试试用 docker 的 ps 命令来查看一下正在运行的容器:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker ps
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们得到来这样的结果</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-14-36-23%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-14-36-23%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-14-36-23%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-14-36-23%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-14-36-23屏幕截图.png"
        title="/img/2022-11-08-14-36-23屏幕截图.png" /></p>
<p>图片可能不太清楚? 这里还是贴出来吧</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[weepingdogel@WeepingDogel-Arch ~]$ sudo docker ps
</span></span><span class="line"><span class="cl">CONTAINER ID   IMAGE     COMMAND       CREATED              STATUS              PORTS     NAMES
</span></span><span class="line"><span class="cl">2f4976200305   ubuntu    &#34;/bin/bash&#34;   About a minute ago   Up About a minute             funny_pare
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后发现了返回的结果中容器 ID 只有上面返回字符串的前面一部分,这个往往是我们会用的容器 ID</p>
<p>要怎样才能控制它的 shell 呢?</p>
<p>又要接触新的 docker 命令了</p>
<ul>
<li>attach</li>
<li>exec</li>
</ul>
<p>exec 需要加上 <code>-i</code> 和 <code>-t</code> 参数以及命令,比如 <code>/bin/bash</code> .</p>
<p>所以执行格式是这样的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker exec -it 容器ID 命令
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后我们需要执行 bash</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker exec -it 2f4976200305 /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div><p>很快,我们就进入了容器的 shell.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-15-03-59%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-15-03-59%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-15-03-59%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-15-03-59%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-15-03-59屏幕截图.png"
        title="/img/2022-11-08-15-03-59屏幕截图.png" /></p>
<p>我们可以用 <code>cat /etc/os-release</code> 来查看系统信息.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-15-05-52%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-15-05-52%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-15-05-52%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-15-05-52%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-15-05-52屏幕截图.png"
        title="/img/2022-11-08-15-05-52屏幕截图.png" /></p>
<p>我们可以很清晰的看到,上面返回的是 Ubuntu 而我用的是 Arch, 因此我们可以确定容器里的东西不会影响到操作系统.</p>
<p>什么?不清晰?那再看清楚一点吧</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PRETTY_NAME=&#34;Ubuntu 22.04.1 LTS&#34;
</span></span><span class="line"><span class="cl">NAME=&#34;Ubuntu&#34;
</span></span><span class="line"><span class="cl">VERSION_ID=&#34;22.04&#34;
</span></span><span class="line"><span class="cl">VERSION=&#34;22.04.1 LTS (Jammy Jellyfish)&#34;
</span></span><span class="line"><span class="cl">VERSION_CODENAME=jammy
</span></span><span class="line"><span class="cl">ID=ubuntu
</span></span><span class="line"><span class="cl">ID_LIKE=debian
</span></span><span class="line"><span class="cl">HOME_URL=&#34;https://www.ubuntu.com/&#34;
</span></span><span class="line"><span class="cl">SUPPORT_URL=&#34;https://help.ubuntu.com/&#34;
</span></span><span class="line"><span class="cl">BUG_REPORT_URL=&#34;https://bugs.launchpad.net/ubuntu/&#34;
</span></span><span class="line"><span class="cl">PRIVACY_POLICY_URL=&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;
</span></span><span class="line"><span class="cl">UBUNTU_CODENAME=jammy
</span></span></code></pre></td></tr></table>
</div>
</div><p>退出还是一样的可以用 <code>exit</code> , 但是此时的 exit 只是退出这个 bash, 它并不会关闭容器.</p>
<p>执行 <code>docker ps</code> 我们可以看到它还在运行.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-15-47-58%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-15-47-58%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-15-47-58%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-15-47-58%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-15-47-58屏幕截图.png"
        title="/img/2022-11-08-15-47-58屏幕截图.png" /></p>
<p>那么我们接下来试试 attach</p>
<p>它的用法是</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker attach 容器ID
</span></span></code></pre></td></tr></table>
</div>
</div><p>所以我需要执行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker attach 2f4976200305
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-16-07-28%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-16-07-28%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-16-07-28%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-16-07-28%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-16-07-28屏幕截图.png"
        title="/img/2022-11-08-16-07-28屏幕截图.png" /></p>
<p>这样一来我们也可以得到一个shell,但是如果我们执行了 <code>exit</code>, 这个容器是会被停止的.</p>
<p>来试试看?</p>
<p>很明显,当 <code>exit</code> 被执行之后用 <code>docker ps</code> 命令看不到正在运行的容器ID,这说明容器被停止了.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-08-16-13-36%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-08-16-13-36%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-08-16-13-36%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-08-16-13-36%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-08-16-13-36屏幕截图.png"
        title="/img/2022-11-08-16-13-36屏幕截图.png" /></p>
<p>如果需要再次启动这个容器呢,我们可以使用 start 或者 restart 命令来重启.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker restart 2f4976200305
</span></span></code></pre></td></tr></table>
</div>
</div><p>此时我们用 <code>docker ps</code> 就又能看到它在运行了</p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>提示<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>使用 <code>docker ps -a</code>命令可以查看所有的容器,无论是否正在运行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker ps -a
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-09-17-27-47%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-09-17-27-47%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-09-17-27-47%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-09-17-27-47%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-09-17-27-47屏幕截图.png"
        title="/img/2022-11-09-17-27-47屏幕截图.png" /></p>
</div>
        </div>
    </div>
<h2 id="删除容器">删除容器</h2>
<p>如果这些容器不需要了怎么办,</p>
<p><del>比如玩坏了,要把它删掉</del></p>
<p>那就要用 <code>docker rm</code> 命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker rm 容器ID
</span></span></code></pre></td></tr></table>
</div>
</div><p>后面接上容器 ID 就能删除, 可以删除多个</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker rm 6c8c8d9f5540 6c49bc1fdc49 eb71e810ee50 5a84d067d769 2addaf3666ef
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后在用 <code>docker ps -a</code> 来查看, 就看不到任何容器 ID 了</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-09-19-05-22%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-09-19-05-22%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-09-19-05-22%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-09-19-05-22%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-09-19-05-22屏幕截图.png"
        title="/img/2022-11-09-19-05-22屏幕截图.png" /></p>
<h2 id="镜像">镜像</h2>
<p>docker 容器运行的前提条件是它需要相应的镜像.</p>
<p>可以用 <code>docker images</code> 来查看本地已经有的镜像, 如果需要的别的镜像可以用 <code>docker pull</code> 来获取</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker images
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-10-12-44-18%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-10-12-44-18%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-10-12-44-18%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-10-12-44-18%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-10-12-44-18屏幕截图.png"
        title="/img/2022-11-10-12-44-18屏幕截图.png" /></p>
<p>我们来获取 php 的镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker pull php
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-10-18-01-21%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-10-18-01-21%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-10-18-01-21%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-10-18-01-21%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-10-18-01-21屏幕截图.png"
        title="/img/2022-11-10-18-01-21屏幕截图.png" /></p>
<p>等待他们自动下载完成,镜像就可以用了.</p>
<p>如果你运行容器的时候没有事先拉取镜像的话, docker 则会在运行容器的时候临时进行拉取.</p>
<p>下载进程完成之后, 我们查看一下现有的镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker images
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">REPOSITORY   TAG       IMAGE ID       CREATED       SIZE
</span></span><span class="line"><span class="cl">ubuntu       latest    a8780b506fa4   7 days ago    77.8MB
</span></span><span class="line"><span class="cl">php          latest    30e567f030d3   12 days ago   484MB
</span></span><span class="line"><span class="cl">httpd        latest    fe8735c23ec5   2 weeks ago   145MB
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>各个选项说明:<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>
<p>REPOSITORY：表示镜像的仓库源</p>
</li>
<li>
<p>TAG：镜像的标签</p>
</li>
<li>
<p>IMAGE ID：镜像ID</p>
</li>
<li>
<p>CREATED：镜像创建时间</p>
</li>
<li>
<p>SIZE：镜像大小</p>
</li>
</ul>
<p>同一仓库源可以有多个 TAG，代表这个仓库源的不同个版本，如 ubuntu 仓库源里，有 <code>15.10</code>、<code>14.04</code> 等多个不同的版本，我们使用 <code>REPOSITORY:TAG</code> 来定义不同的镜像。</p>
<p><a href="https://www.runoob.com/docker/docker-image-usage.html" target="_blank" rel="noopener noreffer ">引自菜鸟教程</a></p>
</div>
        </div>
    </div>
<h2 id="删除镜像">删除镜像</h2>
<p>当然, 不需要的镜像也是可以删除的.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker rmi 镜像ID
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-10--19-35-17%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-10--19-35-17%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-10--19-35-17%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-10--19-35-17%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-10--19-35-17屏幕截图.png"
        title="/img/2022-11-10--19-35-17屏幕截图.png" /></p>
<p>如图,这样就把不需要的镜像删除了</p>
<h2 id="dockerfile">dockerfile</h2>
<p>啥是 dockerfile? Dockerfile 是用来构建镜像文件的文本文件, 文件里面包含的是一条条指令和说明, 和一些 shell 脚本类似(比如 PKGBUILD )</p>
<p>而一个简单的 Dockerfile 是长这样的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> nginx</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;Hello World!&#39;</span> &gt; /usr/share/nginx/html/index.html<span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>来自菜鸟教程的提示<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li><code>FROM</code> 定制的镜像都是基于 FROM 的镜像, 这里的 nginx 就是定制需要的基础镜像。后续的操作都是基于 nginx。</li>
<li><code>RUN</code> 用于执行后面跟着的命令行命令。有以下俩种格式：</li>
</ul>
<p>shell 格式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">RUN</span> &lt;命令行命令&gt;<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># &lt;命令行命令&gt; 等同于，在终端操作的 shell 命令。</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>exec 格式:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">RUN</span> <span class="o">[</span><span class="s2">&#34;可执行文件&#34;</span>, <span class="s2">&#34;参数1&#34;</span>, <span class="s2">&#34;参数2&#34;</span><span class="o">]</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 例如：</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># RUN [&#34;./test.php&#34;, &#34;dev&#34;, &#34;offline&#34;] 等价于 RUN ./test.php dev offline</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<p>熟悉 Linux 操作的话, 上手这玩意也就很简单了, 但是值得注意的是菜鸟教程当中说的这一段:</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>注意<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>Dockerfile 的指令每执行一次都会在 docker 上新建一层。所以过多无意义的层，会造成镜像膨胀过大。例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> centos</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> yum -y install wget<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> wget -O redis.tar.gz <span class="s2">&#34;http://download.redis.io/releases/redis-5.0.3.tar.gz&#34;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> tar -xvf redis.tar.gz<span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>以上执行会创建 3 层镜像。可简化为以下格式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> centos</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> yum -y install wget <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> wget -O redis.tar.gz <span class="s2">&#34;http://download.redis.io/releases/redis-5.0.3.tar.gz&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> tar -xvf redis.tar.gz<span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<p>也就是说我们要尽量在 RUN 当中写命令脚本的时候尽量写并列语句.</p>
<h2 id="一个简单的-web-服务器">一个简单的 Web 服务器.</h2>
<p>现在我想试试用 docker 来跑一个简单的网页了.</p>
<p>就跑一下我之前闲着没事干写的<a href="/simpleLogin/index.html" rel="">登录页面</a>吧.</p>
<p>首先我们要创建一个目录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mkdir webtest
</span></span></code></pre></td></tr></table>
</div>
</div><p>先把前端的静态文件复制进去</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cp test/* webtest/ -rv
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后进入该目录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cd webtest
</span></span></code></pre></td></tr></table>
</div>
</div><p>检查一下文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ls -lh
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">总计 4.0K
</span></span><span class="line"><span class="cl">drwxr-xr-x 2 weepingdogel weepingdogel   23 11月10日 21:30 css
</span></span><span class="line"><span class="cl">drwxr-xr-x 2 weepingdogel weepingdogel    6 11月10日 21:30 img
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 weepingdogel weepingdogel 1.4K 11月10日 21:30 index.html
</span></span><span class="line"><span class="cl">drwxr-xr-x 2 weepingdogel weepingdogel   21 11月10日 21:30 js
</span></span></code></pre></td></tr></table>
</div>
</div><p>ok ,现在我们来写一个 dockerfile</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> nginx</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./index.html /usr/share/nginx/html/index.html<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./css/style.css /usr/share/nginx/html/css/style.css<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./js/main.js /usr/share/nginx/html/js/main.js<span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>指令详解<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>COPY</li>
</ul>
<p>复制指令，从上下文目录中复制文件或者目录到容器里指定路径。</p>
<p>格式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">COPY</span> <span class="o">[</span>--chown<span class="o">=</span>&lt;user&gt;:&lt;group&gt;<span class="o">]</span> &lt;源路径1&gt;...  &lt;目标路径&gt;<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> <span class="o">[</span>--chown<span class="o">=</span>&lt;user&gt;:&lt;group&gt;<span class="o">]</span> <span class="o">[</span><span class="s2">&#34;&lt;源路径1&gt;&#34;</span>,...  <span class="s2">&#34;&lt;目标路径&gt;&#34;</span><span class="o">]</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong><code>[--chown=&lt;user&gt;:&lt;group&gt;]</code></strong>：可选参数，用户改变复制到容器内文件的拥有者和属组。</p>
<p><strong><code>&lt;源路径&gt;</code></strong>：源文件或者源目录，这里可以是通配符表达式，其通配符规则要满足 Go 的 filepath.Match 规则。例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">COPY</span> hom* /mydir/<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> hom?.txt /mydir/<span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong><code>&lt;目标路径&gt;</code></strong>：容器内的指定路径，该路径不用事先建好，路径不存在的话，会自动创建。</p>
</div>
        </div>
    </div>
<p>我的思路和正常的搭建方式一样,安装 nginx 之后再把写好的静态文件复制到web根目录就行, 但是用 docker 的效率高很多.</p>
<p>但是如果不用 docker 的话, 我至少要多花半个小时的时间去配置一个虚拟机, 配置软件源 安装 nginx 什么的, 花的时间就更多了, 而现在我只需要写一个脚本就能一键部署, 而且还能保存为镜像分享给别人,一劳永逸~</p>
<p>好了, 话不多说, 开始构建镜像</p>
<p>使用 <code>docker build</code> 命令通过目录下的 <code>dockerfile</code> 文件构建一个镜像,</p>
<p><code>-t</code> 的属性值是指 <strong><code>&lt;镜像名称:镜像标签&gt;</code></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker build -t webtest:latest .
</span></span></code></pre></td></tr></table>
</div>
</div><p>注意了, 我在最后面还加了一个 <code>.</code> , 这个叫做上写文路径, 也是指相对路径</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>什么叫上下文路径?<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">上下文路径，是指 docker 在构建镜像，有时候想要使用到本机的文件（比如复制），docker build 命令得知这个路径后，会将路径下的所有内容打包。</div>
        </div>
    </div>
<p>然后我们查看一下镜像列表</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker images
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-10-22-19-24%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-10-22-19-24%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-10-22-19-24%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-10-22-19-24%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-10-22-19-24屏幕截图.png"
        title="/img/2022-11-10-22-19-24屏幕截图.png" /></p>
<p>很明显,我们可以看到我们刚刚创建的镜像, 镜像 ID 是 <code>9acd8c30bd5b</code>.</p>
<p>那么接下来把它部署到容器里~ 用 <code>-p</code> 来指定端口绑定 <strong><code>&lt;外部端口:内部端口&gt;</code></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker run -p 8080:80 -d 9acd8c30bd5b
</span></span></code></pre></td></tr></table>
</div>
</div><p>现在我们已经把容器的 80 端口映射到了宿主机的 8080 端口~</p>
<p>然后访问我们的本地 IP + 8080 就可以访问到那个页面了, 我这里用 <code>127.0.0.1:8080</code> 访问</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/2022-11-10-22-27-24%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png"
        data-srcset="/img/2022-11-10-22-27-24%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png, /img/2022-11-10-22-27-24%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 1.5x, /img/2022-11-10-22-27-24%e5%b1%8f%e5%b9%95%e6%88%aa%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="/img/2022-11-10-22-27-24屏幕截图.png"
        title="/img/2022-11-10-22-27-24屏幕截图.png" /></p>
<p>成功访问!</p>
<p>这样一来,快速部署 nginx 就完成了!</p>
<h1 id="结语">结语</h1>
<p>经过对 docker 初学习和初体验, 我也浅尝到了它的高效率和便捷性, 收获还是比较多的.</p>
<p>但目前还是一个入门的阶段,更多高级应用方法还等着去探索~</p>
<p>诶? 你问我难不难? QwQ ~</p>
<p>对 Linux 熟悉的人来玩这个没几天应该就能玩会了, 不过要做到深入的了解还是需要时间的.</p>
<p>那 就这样吧</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2022-10-15</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker" data-via="weepingdogel_me" data-hashtags="docker,运维,容器,Linux,Web,云计算,云服务"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-hashtag="docker"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Pinterest" data-sharer="pinterest" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-description="迟早要学的 Docker ， 先尝试一下吧" data-image="https://w.wallhaven.cc/full/d5/wallhaven-d5we7o.png"><i class="fab fa-pinterest fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Tumblr" data-sharer="tumblr" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker" data-caption="迟早要学的 Docker ， 先尝试一下吧" data-tags="docker,运维,容器,Linux,Web,云计算,云服务"><i class="fab fa-tumblr fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Reddit" data-sharer="reddit" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 VK" data-sharer="vk" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker" data-caption="迟早要学的 Docker ， 先尝试一下吧" data-image="https://w.wallhaven.cc/full/d5/wallhaven-d5we7o.png"><i class="fab fa-vk fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Buffer" data-sharer="buffer" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker" data-via="weepingdogel_me" data-picture="https://w.wallhaven.cc/full/d5/wallhaven-d5we7o.png"><i class="fab fa-buffer fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Xing" data-sharer="xing" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker"><i class="fab fa-xing fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Instapaper" data-sharer="instapaper" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker" data-description="迟早要学的 Docker ， 先尝试一下吧"><i data-svg-src="/lib/simple-icons/icons/instapaper.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Pocket" data-sharer="pocket" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/"><i class="fab fa-get-pocket fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Flipboard" data-sharer="flipboard" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker"><i class="fab fa-flipboard fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker" data-image="https://w.wallhaven.cc/full/d5/wallhaven-d5we7o.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Blogger" data-sharer="blogger" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker" data-description="迟早要学的 Docker ， 先尝试一下吧"><i class="fab fa-blogger fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 百度" data-sharer="baidu" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker"><i data-svg-src="/lib/simple-icons/icons/baidu.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 OK.RU" data-sharer="okru" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker"><i class="fab fa-odnoklassniki fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Evernote" data-sharer="evernote" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker"><i class="fab fa-evernote fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Skype" data-sharer="skype" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker"><i class="fab fa-skype fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Trello" data-sharer="trello" data-url="http://weepingdogel.github.io/zh-cn/posts/%E6%B5%85%E5%B0%9Ddocker/" data-title="浅尝 Docker" data-description="迟早要学的 Docker ， 先尝试一下吧"><i class="fab fa-trello fa-fw" aria-hidden="true"></i></a><a href="//mix.com/add?url=http%3a%2f%2fweepingdogel.github.io%2fzh-cn%2fposts%2f%25E6%25B5%2585%25E5%25B0%259Ddocker%2f&amp;description=%e6%b5%85%e5%b0%9d%20Docker" target="_blank" title="分享到 Mix"><i class="fab fa-mix fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/zh-cn/tags/docker/">docker</a>,&nbsp;<a href="/zh-cn/tags/%E8%BF%90%E7%BB%B4/">运维</a>,&nbsp;<a href="/zh-cn/tags/%E5%AE%B9%E5%99%A8/">容器</a>,&nbsp;<a href="/zh-cn/tags/linux/">Linux</a>,&nbsp;<a href="/zh-cn/tags/web/">Web</a>,&nbsp;<a href="/zh-cn/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a>,&nbsp;<a href="/zh-cn/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1/">云服务</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/zh-cn/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/zh-cn/posts/%E4%B8%80%E5%A4%A9%E5%88%B7%E5%AE%8Clinux%E7%BD%91%E7%BB%9C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%BA%94%E7%94%A8%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E8%BF%99%E6%9C%AC%E4%B9%A6/" class="prev" rel="prev" title="一天刷完《Linux网络操作系统应用基础教程》这本书"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>一天刷完《Linux网络操作系统应用基础教程》这本书</a>
            <a href="/zh-cn/posts/something-about-html-css/" class="next" rel="next" title="关于写 HTML CSS 的时候一些想说的话">关于写 HTML CSS 的时候一些想说的话<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="utterances" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">utterances</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.121.1">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://weepingdogel.github.io" target="_blank">WeepingDogel</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script type="text/javascript" src="/lib/object-fit-images/ofi.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/twemoji/twemoji.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":30},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"title","label":"gitalk","lightTheme":"github-light","repo":"WeepingDogel/WeepingDogel.github.io"}},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/zh-cn/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
